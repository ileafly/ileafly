<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Leafly</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Leafly">
<meta property="og:url" content="http://www.ileafly.com/index.html">
<meta property="og:site_name" content="Leafly">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Leafly">
  
    <link rel="alternate" href="/atom.xml" title="Leafly" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.ileafly.com"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Leafly</a>
      </h1>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-iOS的引用计数与循环引用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/22/iOS的引用计数与循环引用/" class="article-date">
  <time datetime="2018-08-22T05:36:00.000Z" itemprop="datePublished">2018-08-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/22/iOS的引用计数与循环引用/">iOS的引用计数与循环引用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <h2 id="什么是引用计数？"><a href="#什么是引用计数？" class="headerlink" title="什么是引用计数？"></a>什么是引用计数？</h2><p>引用计数是一个简单而有效的管理对象生命周期的方式。</p>
<ul>
<li>当我们创建一个新对象时，它的引用计数为1</li>
<li>当有一个新的指针指向这个对象时，我们将引用计数加1</li>
<li>当某个指针不再指向这个对象时，我们将引用计数减1</li>
<li>当对象的引用计数为0时，说明这个对象不再被任何指针指向了，就可以将对象销毁，回收内存</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-30385df644b8cd5a.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="memory-ref-count.png.jpeg"></p>
<h2 id="引用计数的运用场景"><a href="#引用计数的运用场景" class="headerlink" title="引用计数的运用场景"></a>引用计数的运用场景</h2><p>引用计数真正派上用场的场景是在面向对象的程序设计架构中，用于对象之间传递和共享数据。</p>
<p>以对象M为例，哪些对象需要长时间使用这个对象，就把它的引用计数加1，使用完之后再把引用计数减1.所有对象都遵守这个规则的话，对象的生命周期管理就可以完全交给引用计数了。</p>
<h2 id="ARC下的常见内存管理问题"><a href="#ARC下的常见内存管理问题" class="headerlink" title="ARC下的常见内存管理问题"></a>ARC下的常见内存管理问题</h2><h4 id="循环引用问题-Reference-Cycle"><a href="#循环引用问题-Reference-Cycle" class="headerlink" title="循环引用问题 (Reference Cycle)"></a>循环引用问题 (Reference Cycle)</h4><p>引用计数这种管理内存的方式虽然简单，但是有一个比较大的瑕疵，<code>它不能很好的解决循环引用问题</code></p>
<ol>
<li>什么是循环引用问题？</li>
</ol>
<p>对象A和对象B，相互引用了对方作为自己的成员变量，只有当自己销毁时，才会将成员变量的引用计数减1，这就导致了A的销毁依赖于B的销毁，同样B的销毁依赖于A的销毁，这样就造成了循环引用问题。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-121197b1f2cebf08.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="memory-cycle-1.png.jpeg"></p>
<p>不仅仅只在两个对象中存在循环引用问题，多个对象依次持有对方，形成一个环状，也会造成循环引用问题。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-1943ef26038fcb19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="memory-cycle-2.png"></p>
<ol>
<li>如何解决循环引用问题？</li>
</ol>
<h6 id="主动断开循环引用"><a href="#主动断开循环引用" class="headerlink" title="主动断开循环引用"></a>主动断开循环引用</h6><p>在合理的位置主动断开环中的一个引用，使得对象得以回收。<br><img src="http://upload-images.jianshu.io/upload_images/1479547-f73d7d5934c88e1e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="memory-cycle-3.png"><br>主动断开循环引用这种方式常见于各种与block相关的代码逻辑中。</p>
<p>例如：网络请求的回调block是被持有的，如果这个block中又存在对于View Controller的引用，就容易产生循环引用。</p>
<ul>
<li>Controller 持有网络请求对象</li>
<li>网络请求对象持有了回调的block</li>
<li>回调的block里面使用了self，所以持有了Controller</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">// View Controller</div><div class="line"></div><div class="line">- (void)sendRequest &#123;</div><div class="line">// Controller 持有网络请求对象</div><div class="line">    Request *request = [Request alloc] initWithPath:@&quot;https://www.baidu.com&quot;];</div><div class="line">    [request startWithCompletionBlockWithSuccess:^(Block block) &#123;</div><div class="line">    // 回调的block里面使用了self，所以持有了Controller</div><div class="line">        [self reloadView];</div><div class="line">    &#125; failure:^(NSError *error) &#123;</div><div class="line">        [self toast];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// Request</div><div class="line"></div><div class="line">// 网络请求对象持有了回调block</div><div class="line">- (void)startWithCompletionBlockWithSuccess:(void (^)(Block block))success failure:(void (^)(NSError *error) &#123;</div><div class="line">    self.successCompletionBlock = success;</div><div class="line">    self.failureCompletionBlock = failure;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>解决这个问题的办法就是在网络请求结束后，主动释放对block的持有，打破循环引用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (void)clearCompletionBlock &#123;</div><div class="line">    self.successCompletionBlock = nil;</div><div class="line">    self.failureCompletionBlock = nil;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="使用弱引用"><a href="#使用弱引用" class="headerlink" title="使用弱引用"></a>使用弱引用</h5><p>主动断开循环引用需要程序员能够准确发现循环引用，并知道什么时机断开循环引用，所以这种解决方法并不常见，更常见的办法是使用弱引用</p>
<p>弱引用虽然持有对象，但是不增加引用计数，这样就避免了循环引用的产生。例如delegate模式中的weak声明。View Controller的delegate成员变量通常是一个弱引用，以避免两个View Controller互相引用对方造成循环引用。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-05e4202ef56b249c.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="memory-cycle-4.png.jpeg"></p>
<h5 id="弱引用的实现原理"><a href="#弱引用的实现原理" class="headerlink" title="弱引用的实现原理"></a>弱引用的实现原理</h5><p>系统对于每一个有弱引用的对象，都维护一个表来记录它所有的弱引用的指针地址。当一个对象的引用计数为0时，系统就通过这张表，找到所有的弱引用指针，将他们置为nil。<code>弱引用的使用是有额外的开销的，虽然这个开销很小，但是如果肯定不需要使用弱引用特性时，就不应该盲目使用弱引用</code></p>
<h5 id="Block如何避免循环引用"><a href="#Block如何避免循环引用" class="headerlink" title="Block如何避免循环引用"></a>Block如何避免循环引用</h5><ul>
<li>当block本身不被self持有，而被别的对象持有，同时不产生循环引用的时候，就不需要weakself，最常见的代码就是UIView的动画代码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[UIView animateWithDuration:0.2 animations:^&#123;  </div><div class="line">  self.alpha = 1;</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<ul>
<li>通过weakSelf和strongSelf解决循环引用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">__weak __typeof (self)weakSelf = self;</div><div class="line"></div><div class="line">_observer = [[NSNotificationCenter defaultCenter] addObserverForName:@&quot;Change&quot; object:nil queue:[NSOperationQueue mainQueue] usingBlock:^(NSNotification * _Nonnull note) &#123;</div><div class="line">    __strong __typeof(weakSelf)strongSelf = weakSelf;</div><div class="line">    if (strongSelf) &#123;</div><div class="line">        [strongSelf reload];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>在block之前定义对self的弱引用weakSelf,因为是弱引用，所以self被释放时weakSelf会变成nil</li>
<li>在block中引用该弱引用，考虑到多线程情况，通过强引用strongSelf来引用该弱引用，如果self不为nil，就会retain self，以防在block内部使用过程中self被释放</li>
<li>在block块中使用该强引用strongSelf，注意对strongSelf进行nil检测，因为多线程在弱引用weakSelf对强引用strongSelf赋值时，弱引用weakSelf可能已经为nil了</li>
<li>强引用strongSelf在block作用域结束之后，自动释放</li>
</ol>
<ul>
<li>weakSelf为什么需要strongSelf配合使用</li>
</ul>
<p>在block块中先写一个strongSelf，是为了避免在block的执行过程中，突然出现self被释放的情况。</p>
<h5 id="weak与block的区别"><a href="#weak与block的区别" class="headerlink" title="weak与block的区别"></a><strong>weak与</strong>block的区别</h5><p><code>__weak</code>可以避免循环引用，<code>__block</code>不能避免循环引用，<code>__block</code>的作用是提升变量的作用域</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>引用计数是一种简单高效的管理对象生命周期的方法</li>
<li>引用计数无法避免循环引用</li>
<li>循环引用的解决分为弱引用（事先规避）和主动断开循环引用（事后补救）两个方案</li>
<li><code>__weak</code> 可以避免循环引用，但是其存在外部对象释放后，block内部也访问不到这个对象的问题，所以我们通过在block内部声明一个 <code>__strong</code>的变量来指向weakObj，使得外部对象既能在block内部保持，又能避免循环引用的问题</li>
<li><code>__block</code>无法避免循环引用的问题，它的作用是提升了变量的作用域，在block内外访问的都是同一个对象，如果想要在block中改变变量的值，就需要在变量声明的时候加上<code>__block</code>修饰符</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.ileafly.com/2018/08/22/iOS的引用计数与循环引用/" data-id="cjlop7tzr002c8q799131am2e" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS基础/">iOS基础</a></li></ul>

    </footer>
  </div>
  
</article>
 


  
    <article id="post-引导用户设置支付方式" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/22/引导用户设置支付方式/" class="article-date">
  <time datetime="2018-08-22T05:27:00.000Z" itemprop="datePublished">2018-08-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/22/引导用户设置支付方式/">引导用户设置支付方式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <h2 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h2><p>最近改版项目中的支付方式引导流程，参考了几个大厂他们的设置，发现大家都在引导页中添加了一个<code>去App Store设置</code>的按钮，用户点击后会帮用户自动跳转到App Store并打开用户的账户设置页，这样一来用户就能很方便的在App Store中添加支付宝或微信支付方式了。既然这个流程这么好当然我们也要实现啦。</p>
<h2 id="调研"><a href="#调研" class="headerlink" title="调研"></a>调研</h2><p>网上各种姿势搜索如何帮助用户跳转App Store设置支付方式的页面，发现居然搜不到相关的问题。后来通过抓包分析了其他App调用的链接找到了跳转地址</p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>拿到了跳转地址，后续的流程就简单了，只需要通过<code>openURL</code>方法调用即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@&quot;https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/editAddress?mt=8&quot;]];</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.ileafly.com/2018/08/22/引导用户设置支付方式/" data-id="cjlop7tzy002r8q79g13qejku" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS基础/">iOS基础</a></li></ul>

    </footer>
  </div>
  
</article>
 


  
    <article id="post-iOS导航栏显示与隐藏控制" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/22/iOS导航栏显示与隐藏控制/" class="article-date">
  <time datetime="2018-08-22T05:20:00.000Z" itemprop="datePublished">2018-08-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/22/iOS导航栏显示与隐藏控制/">iOS导航栏显示与隐藏控制</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>最近打算整理优化一下项目中对导航栏的显示与隐藏控制</p>
<h2 id="早期做法"><a href="#早期做法" class="headerlink" title="早期做法"></a>早期做法</h2><p>由于前期项目中需要隐藏导航栏的页面不多，早期采用的方案也比较简单，遵循谁要隐藏自己处理的原则，在需要隐藏的页面的<code>viewWillAppear</code>执行<code>[self.navigationController setNavigationBarHidden:YES animated:YES]</code>，<code>viewWillDisappear</code>执行<code>[self.navigationController setNavigationBarHidden:NO animated:YES]</code>，前期满足了需求，但是随着需要隐藏的页面越来越多，问题也逐渐暴露</p>
<ul>
<li>需要在<code>viewWillAppear</code>和<code>viewWillDisappear</code>控制导航栏的地方越来越多，不便于管理和维护</li>
<li>容易出现人为疏忽，导致导航栏未按预期展现</li>
<li>切换tabBar的情况下，导航栏有一个向上消失的动画</li>
</ul>
<h2 id="升级做法"><a href="#升级做法" class="headerlink" title="升级做法"></a>升级做法</h2><p>鉴于早期方案存在的问题，我打算整理一下导航栏的实现方案</p>
<p>我考虑了两个方案</p>
<ul>
<li>放弃使用原生navigationBar，改用自定义view，灵活控制导航栏的展现</li>
<li>优化现有导航栏显示隐藏方案</li>
</ul>
<p>由于项目已经比较大，现在改自定义view成本太高，所以我打算先从现有方案的优化开始</p>
<h3 id="优化方案"><a href="#优化方案" class="headerlink" title="优化方案"></a>优化方案</h3><p>基于早期的<code>NavigationController</code>基类进行扩展</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">viewDidLoad() &#123;</div><div class="line">    super.viewDidLoad()</div><div class="line">    </div><div class="line">    self.delegate = self</div><div class="line">&#125;</div><div class="line"></div><div class="line">extension ZYNavigationController: UINavigationControllerDelegate &#123;</div><div class="line"></div><div class="line">    func navigationController(_ navigationController: UINavigationController, willShow viewController: UIViewController, animated: Bool) &#123;</div><div class="line">        // 判断要显示的控制器是否是自己</div><div class="line">        let isHidden = viewController.isKind(of: FourthViewController.self) || viewController.isKind(of: FirstViewController.self)</div><div class="line">        </div><div class="line">        self.setNavigationBarHidden(isHidden, animated: true)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>遵循<code>UINavigationControllerDelegate</code>，在<code>willShow viewController</code>方法内判断当前viewController是否需要隐藏导航栏，并根据判断结果设置。<br>这样就能达到，controller在被加载到navigationController内，将要展现前，判断并控制导航栏的显示或隐藏。<br>这里还有一个问题需要解决，那就是导航栏被隐藏后，手势返回功能就会失效，这里就需要我们支持，可以通过<code>interactivePopGestureRecognizer</code>来启动手势返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">viewDidLoad() &#123;</div><div class="line">    super.viewDidLoad()</div><div class="line">    </div><div class="line">    self.delegate = self</div><div class="line">&#125;</div><div class="line"></div><div class="line">extension ZYNavigationController: UINavigationControllerDelegate &#123;</div><div class="line"></div><div class="line">    func navigationController(_ navigationController: UINavigationController, willShow viewController: UIViewController, animated: Bool) &#123;</div><div class="line">        // 判断要显示的控制器是否是自己</div><div class="line">        let isHidden = viewController.isKind(of: FourthViewController.self) || viewController.isKind(of: FirstViewController.self)</div><div class="line">        </div><div class="line">        self.setNavigationBarHidden(isHidden, animated: true)</div><div class="line">        </div><div class="line">        if isHidden &#123;</div><div class="line">            self.interactivePopGestureRecognizer?.delegate = self</div><div class="line">            self.interactivePopGestureRecognizer?.isEnabled = true</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.ileafly.com/2018/08/22/iOS导航栏显示与隐藏控制/" data-id="cjlop7tzo00258q797lbbm8jk" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS基础/">iOS基础</a></li></ul>

    </footer>
  </div>
  
</article>
 


  
    <article id="post-轻松搞定状态栏颜色变化" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/30/轻松搞定状态栏颜色变化/" class="article-date">
  <time datetime="2018-01-30T08:08:00.000Z" itemprop="datePublished">2018-01-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/30/轻松搞定状态栏颜色变化/">轻松搞定状态栏颜色变化</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>iOS系统的状态栏颜色通常有白色和黑色两种，对应的就是<code>UIStatusBarStyleLightContent</code>和<code>UIStatusBarStyleDefault</code>两种样式，改变状态栏的颜色就是通过设置不同的样式来实现的。</p>
<p>iOS为我们提供了两种设置状态栏的方式：统一设置app所有控制器的状态栏颜色和单独设置某个控制器的状态栏颜色</p>
<h2 id="统一设置app所有控制器的状态栏颜色"><a href="#统一设置app所有控制器的状态栏颜色" class="headerlink" title="统一设置app所有控制器的状态栏颜色"></a>统一设置app所有控制器的状态栏颜色</h2><p>首先，我们需要了解一下<code>info.plist</code>里的<code>View Controller-based status bar appearance</code>属性，如果将该属性设为YES，则控制器对状态栏的设置优先级最高，可以在控制器中对颜色进行单独修改，如果将该属性设为NO，则以启动图设置为准，即app内部所有控制器view上的状态栏都与启动图上的保持一致，当然我们还可以通过<code>UIApplication</code>来进行管理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleLightContent animated:YES];</div></pre></td></tr></table></figure>
<h2 id="单独设置某个控制器的状态栏颜色"><a href="#单独设置某个控制器的状态栏颜色" class="headerlink" title="单独设置某个控制器的状态栏颜色"></a>单独设置某个控制器的状态栏颜色</h2><p>单独设置某个控制器的状态栏颜色首先需要将<code>View Controller-based status bar appearance</code>属性设为YES，然后在对应的控制器中加入如下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (UIStatusBarStyle)preferredStatusBarStyle &#123;</div><div class="line">    return UIStatusBarStyleLightContent;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这里需要注意一点就是如果控制器在navigationController或tabBar中，通过自定义navigationController或tabBar重写如下方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (UIViewController *)childViewControllerForStatusBarStyle &#123;</div><div class="line">    return self.topViewController;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="如果随时更改状态栏颜色"><a href="#如果随时更改状态栏颜色" class="headerlink" title="如果随时更改状态栏颜色"></a>如果随时更改状态栏颜色</h2><p>有些特殊情况下，我们需要随时改变当前页面的状态栏颜色，这时就需要通过调用<code>setNeedsStatusBarAppearanceUpdate</code>方法，这个方法会通知系统去调用当前控制器的<code>preferredStatusBarStyle</code>方法，然后根据设置的方法来设置颜色。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.ileafly.com/2018/01/30/轻松搞定状态栏颜色变化/" data-id="cjlop7u0o003p8q790106vjl8" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS基础/">iOS基础</a></li></ul>

    </footer>
  </div>
  
</article>
 


  
    <article id="post-如何使用OmniPlan" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/30/如何使用OmniPlan/" class="article-date">
  <time datetime="2018-01-30T08:05:00.000Z" itemprop="datePublished">2018-01-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/其他/">其他</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/30/如何使用OmniPlan/">如何使用OmniPlan</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>近期项目组打算使用<code>OmniPlan</code>来制定版本开发计划，这里对如何使用<code>OmniPlan</code>进行一个简单的总结。</p>
<h2 id="任务视图"><a href="#任务视图" class="headerlink" title="任务视图"></a>任务视图</h2><p>点击视图控件中的第一个按钮可以看到任务视图。</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch02_02_taskview.png" alt=""></p>
<p>任务视图包含两部分：任务大纲和甘特图，可以方便的在任务大纲创建、编辑和组合相关的任务，甘特图可以很好的表示任务的周期和关系。</p>
<h2 id="资源视图"><a href="#资源视图" class="headerlink" title="资源视图"></a>资源视图</h2><p>点击视图控件的第二个按钮可以看到资源视图。</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch02_03_resourceview.png" alt=""></p>
<p>可以在资源视图里添加和管理人员、设备、材料。资源视图也分两部分：大纲和时间轴。可以在大纲里添加、分组和管理资源，在时间轴里可以通过拖拽、删除快速的给任务分配资源。</p>
<h2 id="日历视图"><a href="#日历视图" class="headerlink" title="日历视图"></a>日历视图</h2><p>点击视图控件的第三个按钮可以看到日历视图。</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch02_04_calendarview.png" alt=""></p>
<p>日历视图分两部分：项目资源列表和编辑工作时间的日历，日历视图还进一步划分了正常时间、额外和业务时间两个模式。<br>在正常时间模式里，可以编辑整个项目的工作日历，单个人员的正常工作时间等等，一般用绿色块表示。<br>在额外和业余时间模式里，可以设置额外时间或假期时间等，分别用蓝色和红色表示。</p>
<h2 id="网络视图"><a href="#网络视图" class="headerlink" title="网络视图"></a>网络视图</h2><p>点击视图控件的第四个按钮可以看到网络视图。</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch02_05_networkview.png" alt=""></p>
<p>网络视图提供了一个画布展示项目的任务和线路图。</p>
<h2 id="样式视图"><a href="#样式视图" class="headerlink" title="样式视图"></a>样式视图</h2><p>点击视图控件的第五个按钮可以看到样式视图。</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch02_06_stylesview.png" alt=""></p>
<p>样式视图主要用于自定义样式风格。</p>
<h2 id="使用流程"><a href="#使用流程" class="headerlink" title="使用流程"></a>使用流程</h2><h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><p>选择<code>文件</code>-&gt;<code>创建</code><br><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch03_01_newfile.png" alt=""><br>创建一个全新的项目，并命名。</p>
<h3 id="选择起止日期"><a href="#选择起止日期" class="headerlink" title="选择起止日期"></a>选择起止日期</h3><p>为项目选择起止时间，如果无法确定截止时间可以只选择起始时间。</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch03_03_projectstart.png" alt=""></p>
<h3 id="创建任务"><a href="#创建任务" class="headerlink" title="创建任务"></a>创建任务</h3><p>在任务视图按下<code>Enter</code>就可以创建一个任务，给每个任务设置持续时间</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch03_06_tasksandmilestones.png" alt=""></p>
<h3 id="创建里程碑"><a href="#创建里程碑" class="headerlink" title="创建里程碑"></a>创建里程碑</h3><p>里程碑是项目的锚点，用来标记重要的节点，创建里程碑可以通过<code>结构</code>-&gt;<code>添加</code>-&gt;<code>里程碑</code>来创建或者将任务类型切换为里程碑。</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch03_04_taskinfomilestone.png" alt=""></p>
<h3 id="编辑工作周"><a href="#编辑工作周" class="headerlink" title="编辑工作周"></a>编辑工作周</h3><p>切换到日历视图，默认情况下工作时间是周一到周五的8:00 AM到5:00 PM，中间有一个小时的午饭时间，不过可以自定义工作时间。</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch03_07_defaultcalendar.png" alt=""></p>
<p>有时因为一些原因不会正常工作，这些时间就需要从我们的工作计划中排查，日历视图下有一个额外和业余时间的模式，通过这个模式可以方便的设置额外或假期时间。</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch03_09_extraandoffhours.png" alt=""></p>
<p>选择对应的日历，双击拖拽会产生一个蓝色区域，这个区域表示正常工作时数之外的可用时数。按住<code>Shift</code>然后拖拽会产生一个红色区域，这个区域会把正常工作时间标记为不可用。</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch03_11_thanksgivingtimeoff.png" alt=""></p>
<h3 id="组任务"><a href="#组任务" class="headerlink" title="组任务"></a>组任务</h3><p>如果任务关系精密或相互依赖，可以把他们放入一个组里。</p>
<p><img src="https://support.omnigroup.com/doc-assets/OmniPlan-Mac/OmniPlan-Mac-v3.6.0.0/en/EPUB/art/op3mac_ch03_13_tasksselectedforgrouping.png" alt=""></p>
<h3 id="链接任务依赖性"><a href="#链接任务依赖性" class="headerlink" title="链接任务依赖性"></a>链接任务依赖性</h3><p>我们不可能同时进行所有的任务，我们可以通过给任务直接建立依赖来排列我们的工作。</p>
<p>选中需要建立依赖的两个任务，点击菜单栏上的<code>关联线</code>按钮，就能成功在两个任务之间建立好依赖。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.ileafly.com/2018/01/30/如何使用OmniPlan/" data-id="cjlop7tzv002j8q792qunpf4l" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/工具/">工具</a></li></ul>

    </footer>
  </div>
  
</article>
 


  
    <article id="post-iOS复制字符串到剪贴板" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/12/14/iOS复制字符串到剪贴板/" class="article-date">
  <time datetime="2017-12-14T11:22:00.000Z" itemprop="datePublished">2017-12-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/14/iOS复制字符串到剪贴板/">iOS复制字符串到剪贴板</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>最近有一个小功能，需要自动帮用户将一些字符串复制到剪贴板中，其实实现比较简单，因为这个功能相对比较生僻，做一个简单记录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">UIPasteboard *pasteboard = [UIPasteboard generalPasteboard];</div><div class="line">pasteboard.string = @&quot;你需要复制的字符串内容&quot;;</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.ileafly.com/2017/12/14/iOS复制字符串到剪贴板/" data-id="cjlop7tzi001r8q79bgdmwmdv" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS基础/">iOS基础</a></li></ul>

    </footer>
  </div>
  
</article>
 


  
    <article id="post-Mac搭建基于Eclipse的J2EE开发环境" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/12/14/Mac搭建基于Eclipse的J2EE开发环境/" class="article-date">
  <time datetime="2017-12-14T11:21:00.000Z" itemprop="datePublished">2017-12-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/其他/">其他</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/14/Mac搭建基于Eclipse的J2EE开发环境/">Mac搭建基于Eclipse的J2EE开发环境</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>虽然网上有各种Mac环境下搭建基于Eclipse的J2EE开发环境的博客，但是在实际参考中或多或少存在着一些偏差，经过一段时间的努力，总算是成功搭建完成并跑通了项目，这里做一个总结供大家参考。</p>
<h2 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h2><ul>
<li>打开终端输入<code>java -version</code>判断是否已安装java运行环境</li>
<li>如果未安装则下载JDK并进行安装 <a href="http://www.oracle.com/technetwork/java/javaee/downloads/java-ee-sdk-7-jdk-7u21-downloads-1956231.html" target="_blank" rel="external">下载地址</a><h2 id="安装Tomcat"><a href="#安装Tomcat" class="headerlink" title="安装Tomcat"></a>安装Tomcat</h2></li>
<li>在<a href="http://tomcat.apache.org" target="_blank" rel="external">Apache官网</a>下载最新的tomcat二进制包</li>
<li>将二进制包解压后改名为Tomcat，并复制到你希望存放的目录，一般存放在<code>/Library</code>目录下</li>
<li>通过终端修改Tomcat的权限 <code>sudo chmod 755 /Library/Tomcat</code></li>
<li>执行<code>/Library/Tomcat/bin/startup.sh</code>启动Tomcat</li>
<li>打开<a href="http://localhost:8080" target="_blank" rel="external">http://localhost:8080</a>验证Tomcat是否安装成功</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/260268-fcc36bece30a4fbd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt=""></p>
<h2 id="安装Eclipse"><a href="#安装Eclipse" class="headerlink" title="安装Eclipse"></a>安装Eclipse</h2><ul>
<li>访问<a href="http://www.eclipse.org/home/index.php" target="_blank" rel="external">Eclipse官方首页</a>下载安装包</li>
<li>执行<code>Eclipse installer</code>，将Eclipse拖入应用程序中</li>
<li>打开Eclipse设置工作空间</li>
</ul>
<h2 id="配置Eclipse"><a href="#配置Eclipse" class="headerlink" title="配置Eclipse"></a>配置Eclipse</h2><ul>
<li>Eclipse 偏好设置</li>
<li>java Installed JREs</li>
<li>Add 选择<code>Standard VM</code></li>
<li><p>Directory 选择本地安装的JDK的路径<br>JDK路径查询命令行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ls -l `which java`</div></pre></td></tr></table></figure>
</li>
<li><p>选中新添加的JRE</p>
</li>
<li>右击项目</li>
<li>选择<code>Java Build Path</code></li>
<li>Add 选择<code>User Library</code></li>
<li>选择Tomcat</li>
<li>配置完成</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.ileafly.com/2017/12/14/Mac搭建基于Eclipse的J2EE开发环境/" data-id="cjlop7tyq00098q79hkyk5asn" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/开发环境/">开发环境</a></li></ul>

    </footer>
  </div>
  
</article>
 


  
    <article id="post-ZYLoading-自定义Loading控件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/12/14/ZYLoading-自定义Loading控件/" class="article-date">
  <time datetime="2017-12-14T11:20:00.000Z" itemprop="datePublished">2017-12-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/14/ZYLoading-自定义Loading控件/">ZYLoading--自定义Loading控件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>移动端项目的开发离不开loading控件，通常为了能快速在项目中实现loading效果我们有几个主流的开源库可以选择：<br><a href="https://github.com/jdg/MBProgressHUD" target="_blank" rel="external">MBProgressHUD</a>、<a href="https://github.com/SVProgressHUD/SVProgressHUD" target="_blank" rel="external">SVProgressHUD</a>等</p>
<p>然后，为了能让整体项目的loading效果显得更加贴切我就想创建一个loading控件，希望此控件能够比较方便的开启、停止loading效果，而且能易于集成和更换logo。</p>
<p>为了达到这个目的，我创建了一个名为<a href="https://github.com/luzhiyongGit/ZYLoading.git" target="_blank" rel="external">ZYLoading</a>的控件，下面就为大家分享一下我这个控件的原理以及使用方法。</p>
<h2 id="原理分析"><a href="#原理分析" class="headerlink" title="原理分析"></a>原理分析</h2><p>此控件的核心思想是利用runtime机制给分类增加成员属性，通过给UIView扩展开启、停止loading的方法，从而实现任何UIView的实例都能方便的开启、停止loading动画</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">#import &quot;UIView+ZYLoadingView.h&quot;</div><div class="line"></div><div class="line">#import &lt;objc/runtime.h&gt;</div><div class="line"></div><div class="line">static char LoadingViewKey;</div><div class="line"></div><div class="line">@implementation UIView (ZYLoadingView)</div><div class="line"></div><div class="line">#pragma mark - Setter</div><div class="line"></div><div class="line">// 将创建的ZYLoadingView实例关联到分类</div><div class="line">- (void)setLoadingView:(ZYLoadingView *)loadingView &#123;</div><div class="line">    [self willChangeValueForKey:@&quot;LoadingViewKey&quot;];</div><div class="line">    objc_setAssociatedObject(self, &amp;LoadingViewKey, loadingView, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</div><div class="line">    [self didChangeValueForKey:@&quot;LoadingViewKey&quot;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 获取关联的ZYLoadingView</div><div class="line">- (ZYLoadingView *)loadingView &#123;</div><div class="line">    return objc_getAssociatedObject(self, &amp;LoadingViewKey);</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 开启动画</div><div class="line">- (void)beginLoading &#123;</div><div class="line">    if (!self.loadingView) &#123;</div><div class="line">        self.loadingView = [[ZYLoadingView alloc] initWithFrame:self.bounds];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    [self addSubview:self.loadingView];</div><div class="line">    </div><div class="line">    [self.loadingView startAnimation];</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 停止动画</div><div class="line">- (void)endLoading &#123;</div><div class="line">    if (self.loadingView) &#123;</div><div class="line">        [self.loadingView stopAnimation];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><h5 id="通过一组图片组合成动画"><a href="#通过一组图片组合成动画" class="headerlink" title="通过一组图片组合成动画"></a>通过一组图片组合成动画</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// 通过枚举选择图片组合动画</div><div class="line">ZYLoadingConfigInstance.loadingType = ZYLoadingAnimateImages;</div><div class="line">// 图片名称</div><div class="line">ZYLoadingConfigInstance.animateImageName = @&quot;zy_loading_&quot;;</div><div class="line">// 图片尺寸</div><div class="line">ZYLoadingConfigInstance.loopImageSize = CGSizeMake(37, 13);</div><div class="line">// 动画过渡时长</div><div class="line">ZYLoadingConfigInstance.duration = 1.f;</div></pre></td></tr></table></figure>
<h5 id="通过一张图旋转形成动画"><a href="#通过一张图旋转形成动画" class="headerlink" title="通过一张图旋转形成动画"></a>通过一张图旋转形成动画</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// 通过枚举选择通过旋转图片展现loading动画</div><div class="line">ZYLoadingConfigInstance.loadingType = ZYLoadingLoopImage;</div><div class="line">// 图片名称</div><div class="line">ZYLoadingConfigInstance.loopImage = [UIImage imageNamed:@&quot;loading_circle&quot;];</div><div class="line">// 图片尺寸    </div><div class="line">ZYLoadingConfigInstance.loopImageSize = CGSizeMake(60, 60);</div><div class="line">// 动画过渡时长    </div><div class="line">ZYLoadingConfigInstance.duration = 0.25f;</div></pre></td></tr></table></figure>
<h5 id="通过一张图片旋转，另一张图片渐隐渐显组合成动画"><a href="#通过一张图片旋转，另一张图片渐隐渐显组合成动画" class="headerlink" title="通过一张图片旋转，另一张图片渐隐渐显组合成动画"></a>通过一张图片旋转，另一张图片渐隐渐显组合成动画</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// 通过枚举选择通过旋转图片展现loading动画    ZYLoadingConfigInstance.loadingType = ZYLoadingLoopImage;</div><div class="line">// 图片名称</div><div class="line">ZYLoadingConfigInstance.loopImage = [UIImage imageNamed:@&quot;loading_circle&quot;];</div><div class="line">// 图片尺寸    </div><div class="line">ZYLoadingConfigInstance.loopImageSize = CGSizeMake(60, 60);</div><div class="line">// logo图片名称</div><div class="line">ZYLoadingConfigInstance.logoImage = [UIImage imageNamed:@&quot;loading_zhangyu&quot;];</div><div class="line">// logo图片尺寸</div><div class="line">ZYLoadingConfigInstance.logoImageSize = CGSizeMake(40, 40);</div><div class="line">// 动画过渡时长</div><div class="line">ZYLoadingConfigInstance.duration = 0.25f;</div></pre></td></tr></table></figure>
<h5 id="开启、停止动画"><a href="#开启、停止动画" class="headerlink" title="开启、停止动画"></a>开启、停止动画</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// 开启动画</div><div class="line">[self.view beginLoading];</div><div class="line"></div><div class="line">// 停止动画</div><div class="line">[self.view endLoading];</div></pre></td></tr></table></figure>
<p>你也可以直接参考github上的<a href="https://github.com/luzhiyongGit/ZYLoading.git" target="_blank" rel="external">ZYLoading</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.ileafly.com/2017/12/14/ZYLoading-自定义Loading控件/" data-id="cjlop7tze001f8q79lwuqr767" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS进阶/">iOS进阶</a></li></ul>

    </footer>
  </div>
  
</article>
 


  
    <article id="post-Xcode9新特性汇总" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/12/14/Xcode9新特性汇总/" class="article-date">
  <time datetime="2017-12-14T11:19:00.000Z" itemprop="datePublished">2017-12-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/14/Xcode9新特性汇总/">Xcode9新特性汇总</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>新版的Xcode 9正式发布了，今天我也将Xcode进行了升级。这次的Xcode更新给我们带来了不少的新特性，这里我进行一个简单的汇总。</p>
<h2 id="Main-Thread-Checker"><a href="#Main-Thread-Checker" class="headerlink" title="Main Thread Checker"></a>Main Thread Checker</h2><p>Xcode 9现在会自动检测UI操作是否在主线程了，一旦代码运行到在非主线程操作UI时就会警告提示，相关代码会高亮，特别方便定位</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-ae5b514cae24218c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Xcode9非主线程操作UI2.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-667852563144f730.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Xcode9非主线程操作UI.png"></p>
<p>以前遇到这种在非主线程操作UI的情况，问题定位相对比较难，需要排查才能找到，现在Xcode 9 给我们提供了非常方便的支持</p>
<h2 id="Swift-Language-Version-支持-4-0和3-2"><a href="#Swift-Language-Version-支持-4-0和3-2" class="headerlink" title="Swift Language Version 支持 4.0和3.2"></a>Swift Language Version 支持 4.0和3.2</h2><p>Xcode 9使用Swift 4编译器，同时支持切换到Swift 3.2，开发者可以根据项目需要选择Swift语言版本</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-22e7d4510d174243.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Xcode9swift语言选择.png"></p>
<h2 id="项目文件路径与本地文件路径自动保持统一"><a href="#项目文件路径与本地文件路径自动保持统一" class="headerlink" title="项目文件路径与本地文件路径自动保持统一"></a>项目文件路径与本地文件路径自动保持统一</h2><p>在以前，为了保证项目文件路径和文件系统中的路径保持一致，我们通常是先在本地路径创建文件夹，然后添加到项目中，现在Xcode 9 将项目文件和文件系统进行了统一，我们可以直接在项目中创建文件或者直接拖拽改变文件位置时，也会相应的改变此文件在文件系统中的位置</p>
<h2 id="Refactor功能改进"><a href="#Refactor功能改进" class="headerlink" title="Refactor功能改进"></a>Refactor功能改进</h2><p><code>Refactor</code>是Xcode一直都提供的一个功能，不过在Xcode 9中进行了优化，Xcode 9将相关代码直接铺在代码编辑器里面，只要滚动编辑框，就可以轻松的看到即将影响到的所有地方，非常的清晰</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-32674d7c60b80bf5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="xcode9refactor.png"></p>
<h2 id="Named-Color"><a href="#Named-Color" class="headerlink" title="Named Color"></a>Named Color</h2><p>Xcode 9支持在xcassets里添加颜色，这样就可以直接在代码或Storyboard里引用这个颜色了，这就非常有利于项目主题颜色的更换</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-4fcc16fe299d6ba4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="named-colors.png"></p>
<h2 id="模拟器升级"><a href="#模拟器升级" class="headerlink" title="模拟器升级"></a>模拟器升级</h2><p>Xcode 9模拟器又改回了之前的拟物化，而且现在支持多个模拟器同时运行，这就对多屏调试方便了很多</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-b9e5bf3b94af0fd3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="xcode9simulator.png"></p>
<h2 id="全新的构建系统"><a href="#全新的构建系统" class="headerlink" title="全新的构建系统"></a>全新的构建系统</h2><p>Xcode 9提供了一个全新的构建系统，这次的构建系统完全使用Swift语言写成，基于Apple的<a href="https://github.com/apple/swift-llbuild" target="_blank" rel="external">llbuild</a>引擎，新的构建系统默认是不开启的，我们可以通过File -&gt; Project Settings 或 File -&gt; Workspace Settings 来切换构建系统</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-58d40d4c79ce3d68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="xcode9build.png"></p>
<h2 id="深度集成Github"><a href="#深度集成Github" class="headerlink" title="深度集成Github"></a>深度集成Github</h2><p>Xcode 9针对Github做了定制化的集成，在Xcode的Preference -&gt; Account 可以添加github账号，这样就能看到完整的项目记录和分支情况</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1479547-7cab79d2f8ebe53d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="xcode9github.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.ileafly.com/2017/12/14/Xcode9新特性汇总/" data-id="cjlop7tz5000x8q79jn4jc7dt" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS基础/">iOS基础</a></li></ul>

    </footer>
  </div>
  
</article>
 


  
    <article id="post-NS-UNAVAILABLE和NS-DESIGNATED是什么" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/12/14/NS-UNAVAILABLE和NS-DESIGNATED是什么/" class="article-date">
  <time datetime="2017-12-14T11:15:00.000Z" itemprop="datePublished">2017-12-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/14/NS-UNAVAILABLE和NS-DESIGNATED是什么/">NS_UNAVAILABLE和NS_DESIGNATED是什么</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>经常我们在阅读一些开源项目的源码时会发现有时候作者会在声明的方法后面添加<code>NS_UNAVAILABLE</code>、<code>NS_EDSIGNATED_INITIALIZER</code>这样的关键字。这表示什么意思呢？</p>
<p>其实，这两个关键字是苹果提供给我们来约束定义方式，使得接口更加清晰的。</p>
<p>下面就来跟大家解释一下这两个字段的具体作用：</p>
<h2 id="NS-UNAVAILABLE"><a href="#NS-UNAVAILABLE" class="headerlink" title="NS_UNAVAILABLE"></a>NS_UNAVAILABLE</h2><p><code>NS_UNAVAILABLE</code>的作用是直接禁止此方法的使用，一般常见用法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">+ (instancetype)new NS_UNAVAILABLE;</div><div class="line">+ (instancetype)init NS_UNAVAILABLE;</div></pre></td></tr></table></figure></p>
<p>这样就不能直接使用这两种创建实例的方法，而需要使用开源库自定义的初始化方法，从而确保了创建实例的统一性</p>
<h2 id="NS-EDSIGNATED-INITIALIZER"><a href="#NS-EDSIGNATED-INITIALIZER" class="headerlink" title="NS_EDSIGNATED_INITIALIZER"></a>NS_EDSIGNATED_INITIALIZER</h2><p><code>NS_EDSIGNATED_INITIALIZER</code>的作用是指定构造器，通常来说指定初始化函数对一个类来说非常重要，参数也会比较多，为了适应不同的初始化需求就有了便利初始化函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (instancetype)initWithName:(NSString *)name NS_EDSIGNATED_INITIALIZER;</div></pre></td></tr></table></figure>
<p>声明指定构造器函数的一个目的是帮助规范代码，找到程序中潜在问题。</p>
<p>在Objective-C中，指定初始化函数的使用有一些规范：</p>
<ul>
<li>子类如果有指定初始化函数，那么指定初始化函数实现时必须调用它的直接父类的指定初始化函数</li>
<li>如果子类有指定初始化函数，那么便利初始化函数必须调用自己的其他初始化函数，不能调用super的初始化函数。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.ileafly.com/2017/12/14/NS-UNAVAILABLE和NS-DESIGNATED是什么/" data-id="cjlop7tz0000m8q79kr4q1cic" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS基础/">iOS基础</a></li></ul>

    </footer>
  </div>
  
</article>
 


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">下一页&raquo;</a>
  </nav>
</section>
           
    <aside id="sidebar">
  
    
  <div class="widget-wrap">
     
        <h3 class="follow-title ">Follow me</h3>
     
    <div class="widget follow">
      
              <a class="github" aria-hidden="true" href="https://github.com/luzhiyongGit" target="_blank" title="Github"></a>
      
      
      
      
            <a class="email" aria-hidden="true"  href="mailto:luzhiyongmail@sohu.com" target="_blank" title="邮箱"></a>
      
    </div>
  </div>


  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title categories">分类</h3>
    <div class="widget" id="categories">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ReactNative/">ReactNative</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><span class="category-list-count">33</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/PHP/">PHP</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/其他/">其他</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title tagcloud">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Bootstrap/" style="font-size: 14px;">Bootstrap</a> <a href="/tags/Markdown/" style="font-size: 14px;">Markdown</a> <a href="/tags/Swift/" style="font-size: 14px;">Swift</a> <a href="/tags/epub/" style="font-size: 14px;">epub</a> <a href="/tags/iOS基础/" style="font-size: 25px;">iOS基础</a> <a href="/tags/iOS技巧/" style="font-size: 19.5px;">iOS技巧</a> <a href="/tags/iOS进阶/" style="font-size: 22.25px;">iOS进阶</a> <a href="/tags/reader/" style="font-size: 14px;">reader</a> <a href="/tags/加密/" style="font-size: 14px;">加密</a> <a href="/tags/博客/" style="font-size: 16.75px;">博客</a> <a href="/tags/工具/" style="font-size: 14px;">工具</a> <a href="/tags/开发环境/" style="font-size: 14px;">开发环境</a> <a href="/tags/版本控制/" style="font-size: 14px;">版本控制</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title recent-posts">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/08/22/iOS的引用计数与循环引用/">iOS的引用计数与循环引用</a>
          </li>
        
          <li>
            <a href="/2018/08/22/引导用户设置支付方式/">引导用户设置支付方式</a>
          </li>
        
          <li>
            <a href="/2018/08/22/iOS导航栏显示与隐藏控制/">iOS导航栏显示与隐藏控制</a>
          </li>
        
          <li>
            <a href="/2018/01/30/轻松搞定状态栏颜色变化/">轻松搞定状态栏颜色变化</a>
          </li>
        
          <li>
            <a href="/2018/01/30/如何使用OmniPlan/">如何使用OmniPlan</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title archive">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">5</span></li></ul>
    </div>
  </div>


  
    
<div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
        <ul>
            
            <li>
                <a href="https://www.jianshu.com/u/ca60cab2466b">我的简书</a>
            </li>
            
        </ul>
    </div>
</div>

  
    <!--微信公众号二维码-->


  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2014 - 2018 Leafly&nbsp;|&nbsp;
      主题 <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
     <div id="footer-right">
      联系方式&nbsp;|&nbsp;luzhiyongmail@sohu.com
    </div>
  </div>
</footer>
 <script src="/jquery/jquery.min.js"></script>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      

  
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "e2fb4051c49842688ce669e634bc983f",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
    

  







<!-- author:forvoid begin -->
<!-- author:forvoid begin -->

<!-- author:forvoid end -->

<!-- author:forvoid end -->


  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


 <script src="/js/is.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/elevator.js"></script>
  </div>
</body>
</html>